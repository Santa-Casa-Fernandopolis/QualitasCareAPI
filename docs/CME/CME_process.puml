@startuml
title Fluxo Macro de Processos – CME (QualitasCare)

' Paginação para impressão em folhas A4
page 1x3
skinparam pageMargin 10
skinparam dpi 150

start
:Recebimento de Material Contaminado;
note right
Registrar origem (setor/sala),
profissional que entrega, volume,
classe de resíduo associada ao PGRSS.
end note

if (Triagem/Condição do Material) then (Apto)
  :Pré-limpeza / Desmontagem;
  :Limpeza e Descontaminação;
  repeat
    :Checklist Lavadora Ultrassônica (DIÁRIO);
    if (Checklist do dia OK?) then (Sim)
      ' Checklist validado, seguir fluxo
    else (Não)
      :Bloquear Produção;
      :Abrir NC (Checklist não realizado);
      :Anexar checklist digital em EvidenciaArquivo;
      :Executar checklist e reinspecionar;
    endif
  repeat while (Checklist do dia OK?) is (Não)
  :Secagem e Inspeção de integridade;
  :Montagem do Kit/Bandeja;
  :Conferência de itens críticos;
  :Gerar Etiqueta + QR (lote, data, validade, COREn);
  :Capturar evidências da montagem (fotos/checklist);
  :Armazenar p/ Esterilização;
  :Carregar Autoclave;
  repeat
    :Teste Bowie-Dick (antes do 1º ciclo do dia);
    if (Bowie-Dick Conforme?) then (Sim)
      :Anexar foto/relatório do BD;
      ' Autoclave liberada
    else (Não)
      :Bloquear Autoclave;
      :Abrir Não Conformidade (BD);
      :Acionar Plano de Ação quando severo;
      :Adicionar evidências (foto, relatório técnico);
      :Ação corretiva/manutenção;
      :Repetir BD;
    endif
  repeat while (Bowie-Dick Conforme?) is (Não)
  repeat
    :Executar Ciclo de Esterilização;
    :Aplicar CI (por pacote) e BI (por carga conforme POP);
    :Digitalizar resultados CI/BI e anexar evidências;
    if (Resultados CI/BI OK?) then (Sim)
      ' Liberação autorizada
    else (Não)
      :Bloquear Liberação;
      :Abrir Não Conformidade (falha CI/BI);
      :Associar Plano de Ação e GeracaoResiduo (se aplicável);
      :Registrar evidências adicionais;
      :Ação Corretiva (manutenção/verificação);
      :Encaminhar para Reprocesso;
    endif
  repeat while (Resultados CI/BI OK?) is (Não)
  :Registrar "Liberação de Lote";
  :Armazenamento em área estéril;
  :Distribuição/Entrega ao Setor (scan QR);
  :Uso no Paciente (setor lança evento opcional);
  :Retorno Contaminado (scan QR);
  :Registrar culturas/laboratório + anexar laudos;
  :Atualizar rastreabilidade ambiental (GeracaoResiduo quando necessário);
  :Rastreabilidade Reversa → Expurgo;
  stop

else (Inapto)
  :Registrar Perda/Separar para manutenção;
  :Rastrear como resíduo conforme PGRSS;
  stop
endif

@enduml
